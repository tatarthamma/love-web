<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô <head> -->
  <link href="https://fonts.googleapis.com/css2?family=Mitr:wght@400;600;700&family=Sarabun:wght@400;600&display=swap" rel="stylesheet">

  <title>Happy Birthday My Love</title>
  <style>
    body {
      background-image: url(https://i.postimg.cc/jdrhsQ4G/Chat-GPT-Image-28-2568-16-05-20.png);
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
    }

    .center, #cakeGame {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      text-align: center;
      padding: 2rem;
    }

    .photo {
      width: 200px;
      height: 200px;
      object-fit: cover;
      border-radius: 50%;
      border: 5px solid #ff66b2;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      margin-bottom: 1rem;
    }
    
    h1 {
      font-size: 3.5rem;
      color: #ff66b2;
      margin: 0rem 0; /* ‡∏à‡∏≤‡∏Å 0.5rem ‚Üí 0.2rem */
      text-shadow: 2px 2px 4px #fff;
    }

    
    .typewriter {
      font-size: 1.4rem; /* ‡∏•‡∏î‡∏•‡∏á‡∏à‡∏≤‡∏Å 1.8 ‡πÄ‡∏õ‡πá‡∏ô 1.4 */
      color: #333;
      white-space: nowrap;
      overflow: hidden;
      width: 0;
      animation: typing 6s steps(40, end) forwards;

    }
    
    #puzzleTitle {
  font-size: 1.8rem;       /* ‡πÄ‡∏î‡∏¥‡∏° 2rem ‚Üí ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á */
  background: rgba(255, 255, 255, 0.7);
  padding: 10px 18px;
  border-radius: 12px;
  display: inline-block;
  box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  backdrop-filter: blur(3px);
  color: #cc0077;
  margin-bottom: 8px;
}

#puzzleInstructions {
  font-size: 1rem;         /* ‡πÄ‡∏î‡∏¥‡∏° 1.1rem ‚Üí ‡∏•‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
  padding: 8px 16px;
  border-radius: 10px;
  display: inline-block;
  box-shadow: 0 4px 8px rgba(255, 255, 255, 0.1);
  color: #273050;
  line-height: 1.4;
  margin-bottom: 16px;
}






    @keyframes typing {
      from { width: 0; }
      to { width: 100%; }
    }

    #giftBtn, .reveal-btn {
      margin-top: 30px;
      padding: 14px 30px;
      font-size: 1.3rem;
      background: linear-gradient(45deg, #ff99cc, #ff66b2);
      color: white;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
    }

    #giftBtn:hover, .reveal-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 12px rgba(0,0,0,0.3);
    }

    #cakeGame {
      display: none;
      flex-direction: column;
      align-items: center;
    }

    #mainPage {
  transition: opacity 0.5s ease;
}


    .cakes {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 30px;
    }

    .cake {
      width: 120px;
      height: 120px;
      cursor: pointer;
      border-radius: 12px;
      transition: transform 0.2s ease;
    }

    .cake:hover {
      transform: scale(1.1);
    }

    #resultMsg {
      margin-top: 20px;
      font-size: 1.2rem;
      color: #cc0077;
    }

    .heart {
    position: fixed;
    width: 20px;
    height: 20px;
    background: pink;
    transform: rotate(45deg);
    animation: floatUp 15s linear forwards;
    z-index: 0;
    opacity: 0.7;
  }

  .heart::before,
  .heart::after {
    content: '';
    position: absolute;
    width: 20px;
    height: 20px;
    background: inherit;
    border-radius: 50%;
  }

  .heart::before {
    top: -10px;
    left: 0;
  }

  .heart::after {
    top: 0;
    left: -10px;
  }

  @keyframes floatUp {
    0% {
      transform: translateY(0) rotate(45deg);
      opacity: 0.8;
    }
    100% {
      transform: translateY(-270vh) rotate(45deg);
      opacity: 0;
    }
  }

    .gift-boxes {
    display: flex;
    gap: 40px;
    margin-top: 30px;
  }
  .gift {
    width: 120px;
    cursor: pointer;
    transition: transform 0.2s;
  }
  .gift:hover {
    transform: scale(1.1);
  }
  .popup {
    position: fixed;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.15); /* ‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™ */
    backdrop-filter: blur(4px);        /* ‡πÄ‡∏ö‡∏•‡∏≠‡πÅ‡∏ö‡∏ö‡∏ô‡∏∏‡πà‡∏°‡∏´‡∏£‡∏π */
    justify-content: center;
    align-items: center;
    display: flex;
    z-index: 999;
  }

  .popup-content {
    background: #fff;
    padding: 30px;
    border-radius: 16px;
    text-align: center;
    box-shadow: 0 8px 16px rgba(0,0,0,0.3);
  }

  /* ===== Letter Popup (‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏™‡∏î‡πÉ‡∏™) ===== */
.popup--letter {
  background: radial-gradient(rgba(255, 240, 246, 0.65), rgba(255, 255, 255, 0.2));
  backdrop-filter: blur(6px);
}

.letter-card {
  position: relative;
  max-width: 360px;
  width: calc(100% - 40px);
  padding: 28px 24px 24px;
  border-radius: 20px;
  background: linear-gradient(180deg, #ffffff, #fff9fb);
  box-shadow:
    0 12px 30px rgba(255, 102, 178, 0.25),
    0 6px 14px rgba(0, 0, 0, 0.08);
  border: 3px solid transparent;
  background-clip: padding-box;
  animation: letter-pop-in .45s ease-out both;
}

/* ===== Success Popup (cute) ===== */
.popup--success{
  background: radial-gradient(rgba(255,240,246,.65), rgba(255,255,255,.2));
  backdrop-filter: blur(6px);
}

.success-card{
  position: relative;
  max-width: 420px;
  width: calc(100% - 40px);
  padding: 28px 22px 20px;
  border-radius: 22px;
  background: linear-gradient(180deg, #ffffff, #fff6fb);
  border: 3px solid transparent;
  background-clip: padding-box;
  box-shadow: 0 14px 34px rgba(255,102,178,.28), 0 8px 18px rgba(0,0,0,.08);
  animation: pop-in .45s ease-out both;
}
.success-card::before{
  content:"";
  position:absolute; inset:-3px; border-radius:24px;
  background: linear-gradient(135deg,#ff96c8,#ffd1e8,#ffffff);
  z-index:-1;
}

.success-title{
  color:#cc0077; margin: 6px 0 6px; text-align:center;
}
.success-text{
  color:#555; text-align:center; margin:0 0 12px;
}

/* Badge ‡∏Å‡∏•‡∏° ‡πÜ ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
.success-badge{
  position:relative;
  width:96px; height:96px; margin:-62px auto 6px;
  filter: drop-shadow(0 8px 14px rgba(255,102,178,.25));
}
.badge-ring{
  background: conic-gradient(from 0deg, #ff79bd, #ffd1e8, #fff, #ff79bd);
}
.badge-core{
  position:absolute; inset:10px; border-radius:50%;
  display:grid; place-items:center;
  background: radial-gradient(#fff, #ffe6f2);
  font-size: 34px;
}
/* ‡∏õ‡∏∏‡πà‡∏° */
.success-actions{
  display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin-top: 8px;
}
.btn-primary{
  padding: 12px 22px; border:none; border-radius:999px;
  background: linear-gradient(45deg,#ff99cc,#ff66b2);
  color:#fff; font-size:1rem; cursor:pointer;
  box-shadow: 0 8px 18px rgba(255,102,178,.35);
  transition: transform .15s ease, box-shadow .2s ease;
  animation: pulse 1.6s ease-in-out infinite;
}
.btn-primary:hover{ transform: translateY(-1px) scale(1.03); box-shadow: 0 12px 24px rgba(255,102,178,.45); }

.btn-ghost{
  padding: 11px 18px; border-radius:999px; border:2px solid #ffd1e8; background:#fff;
  color:#a80062; cursor:pointer; transition: transform .15s ease, box-shadow .2s ease;
}
.btn-ghost:hover{ transform: translateY(-1px); box-shadow: 0 8px 18px rgba(0,0,0,.08); }

/* ‡∏™‡∏õ‡∏≤‡∏£‡πå‡∏Å‡πÄ‡∏Ñ‡∏¥‡∏•‡∏•‡∏≠‡∏¢‡∏ï‡∏•‡∏≠‡∏î */
.success-sparkle{
  position:absolute; width:7px; height:7px; border-radius:50%;
  background: radial-gradient(#fff,#ffd1e8);
  pointer-events:none; opacity:.95;
  animation: sparkle-float 2s ease-out forwards;
}

/* Keyframes */
@keyframes pop-in{
  from{ transform: translateY(6px) scale(.98); opacity:0; }
  to{ transform: translateY(0) scale(1); opacity:1; }
}
@keyframes spin{ to{ transform: rotate(360deg); } }
@keyframes pulse{
  0%,100%{ transform: translateY(0) scale(1); }
  50%{ transform: translateY(-1px) scale(1.03); }
}
@keyframes sparkle-float{
  to{ transform: translateY(-46px) translateX(var(--dx)); opacity:0; }
}


/* ‡∏Å‡∏£‡∏≠‡∏ö‡πÑ‡∏•‡πà‡∏™‡∏µ‡∏î‡πâ‡∏≤‡∏ô‡∏ô‡∏≠‡∏Å */
.letter-card::before {
  content: "";
  position: absolute;
  inset: -3px;
  border-radius: 22px;
  background: linear-gradient(135deg, #ff96c8, #ffd1e8, #ffffff);
  z-index: -1;
}

/* ‡∏ã‡∏≠‡∏á‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢ */
.letter-envelope {
  position: relative;
  display: grid;
  place-items: center;
  margin: 6px 0 10px;
}
.letter-icon {
  width: 120px;
  filter: drop-shadow(0 6px 10px rgba(0,0,0,0.12));
}
.envelope-top {
  position: absolute;
  top: -6px;
  width: 120px;
  height: 70px;
  background: linear-gradient(180deg, #ffd6e7, #ffc1dc);
  clip-path: polygon(0 0, 100% 0, 50% 70%);
  transform-origin: top;
  animation: flap 1.4s ease-in-out infinite alternate;
}
.heart-stamp {
  position: absolute;
  right: 8px;
  bottom: -8px;
  font-size: 28px;
  transform: rotate(-12deg);
  text-shadow: 0 2px 0 rgba(0,0,0,0.08);
}

/* ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
#letterTitle { color: #cc0077; margin: 8px 0 6px; }
.letter-text { color: #555; margin: 0 0 12px; }

/* ‡∏õ‡∏∏‡πà‡∏° CTA ‡∏ß‡∏¥‡πâ‡∏á ‡πÜ */
.letter-cta {
  margin-top: 6px;
  padding: 12px 26px;
  font-size: 1.05rem;
  background: linear-gradient(45deg, #ff99cc, #ff66b2);
  color: #fff;
  border: none;
  border-radius: 999px;
  cursor: pointer;
  box-shadow: 0 6px 14px rgba(255, 102, 178, 0.35);
  transition: transform .15s ease, box-shadow .2s ease;
  animation: pulse 1.6s ease-in-out infinite;
}
.letter-cta:hover {
  transform: translateY(-1px) scale(1.03);
  box-shadow: 0 10px 22px rgba(255, 102, 178, 0.45);
}

.letter-hint {
  display: block;
  margin-top: 10px;
  color: #8a8a8a;
  font-size: .85rem;
}

/* ‡∏™‡∏õ‡∏≤‡∏£‡πå‡∏Å‡πÄ‡∏Ñ‡∏¥‡∏•‡∏ó‡∏µ‡πà‡πÇ‡∏õ‡∏£‡∏¢‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î popup */
.sparkle {
  position: absolute;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: radial-gradient(#fff, #ffd1e8);
  opacity: 0.9;
  pointer-events: none;
  animation: sparkle-float 2s ease-out forwards;
}


/* ‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô */
@keyframes flap {
  0%   { transform: rotateX(0deg); }
  100% { transform: rotateX(35deg); }
}
@keyframes pulse {
  0%   { transform: translateY(0) scale(1); }
  50%  { transform: translateY(-1px) scale(1.03); }
  100% { transform: translateY(0) scale(1); }
}
@keyframes sparkle-float {
  to { transform: translateY(-40px) translateX(var(--dx)) scale(0.6); opacity: 0; }
}
@keyframes letter-pop-in {
  from { transform: translateY(4px) scale(0.98); opacity: 0; }
  to   { transform: translateY(0) scale(1); opacity: 1; }
}


  .gift-item {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.gift-label {
  margin-top: 8px;
  font-size: 1rem;
  color: #cc0077;
  font-weight: 500;
  text-align: center;
}

.gift-grid {
  display: flex;
  justify-content: center;
  gap: 40px;
  padding: 30px;
  background: linear-gradient(145deg, #fff0f5, #ffe4ec); /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ô‡∏∏‡πà‡∏°‡πÜ */
  border-radius: 20px;
  box-shadow: inset 0 2px 10px rgba(255, 182, 193, 0.3),
              0 8px 20px rgba(0, 0, 0, 0.15); /* ‡∏°‡∏µ‡∏°‡∏¥‡∏ï‡∏¥ */
}

.gift {
  background: white;
  padding: 15px;
  border-radius: 15px;
  box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1),
              inset 0 2px 5px rgba(255, 255, 255, 0.8);
  transition: all 0.3s ease;
  cursor: pointer;
}

.gift img {
  width: 120px;
  height: auto;
  border-radius: 10px;
  transition: transform 0.3s ease;
}

.gift:hover {
  transform: translateY(-8px);
  box-shadow: 0 10px 25px rgba(255, 105, 180, 0.4);
}

.gift:hover img {
  transform: scale(1.05);
}


  
  .popup-content button:hover {
  transform: scale(1.05);
  background: linear-gradient(45deg, #ff66cc, #ff3399);
}

  .hidden {
    display: none;
  }

  .party-popper {
  position: fixed;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  z-index: 1000;
  opacity: 0.95;
  pointer-events: none;
}

/* ===== Cute Puzzle UI ===== */
:root{
  --pz-accent: #ff66b2;
  --pz-soft: #fff2f7;
  --pz-shadow: 0 10px 26px rgba(255, 102, 178, .25);
  --pz-card: linear-gradient(180deg, #ffffff, #fff6fb);
  --pz-tile: clamp(80px, 22vw, 120px); /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ä‡∏¥‡πâ‡∏ô‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏ï‡∏≤‡∏°‡∏à‡∏≠ */
}

.puzzle-card{
  position: relative;
  max-width: min(95vw, 420px);
  width: 100%;
  padding: 18px 16px 16px;
  border-radius: 22px;
  background: var(--pz-card);
  box-shadow: var(--pz-shadow);
  border: 2px solid #ffd1e8;
  margin: 0 auto; /* ‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */

}

.puzzle-head{
  display: grid;
  gap: 6px;
  text-align: center;
  margin-bottom: 10px;
}
.puzzle-title{
  font-size: 1.4rem;
  color: #cc0077;
  margin: 0;
}
.puzzle-sub{
  font-size: .95rem;
  color: #555;
  margin: 0;
}
.puzzle-chips{
  display: flex; justify-content: center; gap: 8px; margin-top: 4px;
}
.chip{
  background: #ffe6f2;
  color: #a80062;
  padding: 4px 10px;
  border-radius: 999px;
  font-size: .8rem;
  box-shadow: 0 4px 10px rgba(255, 102, 178, .15);
}

.puzzle-grid{
  display: grid;
  grid-template-columns: repeat(3, var(--pz-tile));
  grid-auto-rows: var(--pz-tile);
  gap: 8px;
  padding: 8px;
  border-radius: 18px;
  background: linear-gradient(145deg, #fff0f5, #ffe3ee);
  box-shadow: inset 0 2px 12px rgba(255, 182, 193, .35);
  
  /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á */
  margin: 10px auto 12px; /* auto ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
  justify-content: center; /* ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ container */
}


/* ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏•‡∏Ç‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≥‡∏ö‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏¥‡πâ‡∏ô ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏´‡∏°‡∏î hint */
.puzzle-grid.show-labels img::after{
  content: attr(data-label);
  position: absolute;
  top: 6px; left: 8px;
  font-size: .8rem;
  color: #fff;
  background: rgba(204, 0, 119, .8);
  border-radius: 10px;
  padding: 2px 6px;
  transform: translateZ(0);
}

/* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ IMG ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ::after */
.puzzle-grid img{
  position: relative;
}

.puzzle-piece{
  width: 100%; height: 100%;
  object-fit: cover;
  border-radius: 12px;
  box-shadow:
    0 6px 14px rgba(0,0,0,.12),
    inset 0 2px 4px rgba(255,255,255,.8);
  cursor: grab;
  transition: transform .15s ease, box-shadow .2s ease, filter .2s ease;
  background: #fff;
}
.puzzle-piece:active{ cursor: grabbing; }
.puzzle-piece:hover{
  transform: translateY(-2px) scale(1.02);
  box-shadow:
    0 10px 20px rgba(255, 105, 180, .35),
    inset 0 2px 6px rgba(255,255,255,.9);
  filter: saturate(1.05);
}

.puzzle-actions{
  display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;
}
.btn-cute{
  padding: 10px 18px;
  border: none; border-radius: 999px;
  background: linear-gradient(45deg, #ff99cc, #ff66b2);
  color: #fff; font-size: .98rem;
  box-shadow: 0 6px 14px rgba(255,102,178,.3);
  cursor: pointer;
  transition: transform .15s ease, box-shadow .2s ease;
}
.btn-cute:hover{ transform: translateY(-1px) scale(1.02); box-shadow: 0 10px 22px rgba(255,102,178,.45); }
.btn-ghost{
  background: #fff;
  color: #a80062;
  border: 2px solid #ffd1e8;
}

/* ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ */
.puzzle-status{
  text-align: center;
  margin: 6px 0 2px;
  min-height: 22px;
  color: #a80062;
  font-weight: 500;
}

/* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏¥‡∏î: ‡∏™‡∏±‡πà‡∏ô‡∏ô‡∏¥‡∏î ‡πÜ */
.shake{
  animation: shake .35s ease;
}
@keyframes shake{
  0%,100%{ transform: translateX(0); }
  20%{ transform: translateX(-6px); }
  40%{ transform: translateX(6px); }
  60%{ transform: translateX(-4px); }
  80%{ transform: translateX(4px); }
}

/* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏â‡∏•‡∏≠‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏π‡∏Å */
.celebrate{
  box-shadow:
    0 12px 30px rgba(102, 204, 255, .25),
    0 6px 16px rgba(255, 204, 0, .25);
  transition: box-shadow .4s ease;
}

/* ===== Final Game (cute) ===== */
.final-card{
  position: relative;
  max-width: 760px;
  width: calc(100% - 40px);
  padding: 20px 18px 18px;
  border-radius: 24px;
  background: linear-gradient(180deg,#ffffff,#fff6fb);
  box-shadow: 0 16px 36px rgba(255,102,178,.22), 0 8px 18px rgba(0,0,0,.06);
  border: 3px solid transparent;
  background-clip: padding-box;
}
.final-card::before{
  content:"";
  position:absolute; inset:-3px; border-radius:26px;
  background: linear-gradient(135deg,#ff96c8,#ffd1e8,#ffffff);
  z-index:-1;
}

.final-head{ text-align:center; margin-bottom: 8px; }
.final-title{ color:#cc0077; margin: 6px 0 6px; font-size: 1.8rem; }
.final-sub{ color:#555; margin: 0; }
.final-chips{ margin-top:8px; display:flex; gap:8px; justify-content:center; }
.chip{
  background:#ffe6f2; color:#a80062; padding:4px 10px; border-radius: 999px;
  font-size:.85rem; box-shadow: 0 4px 10px rgba(255,102,178,.15);
}

.gift-grid-3{
  display:grid;
  grid-template-columns: repeat(3, minmax(140px, 1fr));
  gap: 16px;
  margin: 14px auto 10px;
  justify-items: center;
}
@media (max-width: 640px){
  .gift-grid-3{ grid-template-columns: repeat(3, 1fr); gap: 12px; }
}

.gift-card{
  position: relative;
  width: min(200px, 26vw);
  aspect-ratio: 1 / 1.08;
  border: none; background: #fff; border-radius: 18px;
  box-shadow: 0 12px 24px rgba(0,0,0,.08), inset 0 2px 6px rgba(255,255,255,.9);
  cursor:pointer;
  transform: translateZ(0);
  transition: transform .15s ease, box-shadow .2s ease, filter .2s ease;
  overflow: hidden;
}
.gift-card:hover{
  transform: translateY(-4px) scale(1.02);
  box-shadow: 0 16px 30px rgba(255,105,180,.28);
  filter: saturate(1.03);
}
.gift-card:focus{ outline: 3px solid #ffd1e8; outline-offset: 3px; }

.gift-img{
  width: 78%;
  height: auto;
  display:block;
  margin: 18px auto 10px;
  border-radius: 12px;
  box-shadow: 0 8px 16px rgba(0,0,0,.08);
}

.gift-tag{
  position: absolute;
  left: 50%; transform: translateX(-50%);
  bottom: 10px;
  background: #ffe6f2; color:#a80062;
  padding: 6px 12px; border-radius: 999px; font-size: .9rem;
  box-shadow: 0 6px 14px rgba(255,102,178,.22);
}

.gift-ribbon{
  position: absolute; top: 10px; left: 50%; transform: translateX(-50%);
  width: 84%; height: 30px; border-radius: 999px;
  background: linear-gradient(90deg,#ff99cc,#ff66b2);
  box-shadow: 0 8px 18px rgba(255,102,178,.35);
}
.gift-ribbon::before, .gift-ribbon::after{
  content:""; position:absolute; top:22px; width: 18px; height: 22px; border-radius: 4px;
  background: linear-gradient(180deg,#ff99cc,#ff66b2);
  filter: drop-shadow(0 2px 4px rgba(0,0,0,.12));
}
.gift-ribbon::before{ left: 12%; transform: rotate(-12deg); }
.gift-ribbon::after{ right: 12%; transform: rotate(12deg); }

.gift-shine{
  position:absolute; inset:0; pointer-events:none;
  background: linear-gradient(110deg, rgba(255,255,255,.0) 10%, rgba(255,255,255,.35) 35%, rgba(255,255,255,.0) 60%);
  transform: translateX(-120%) skewX(-12deg);
  animation: shine-sweep 4s ease-in-out infinite;
}
@keyframes shine-sweep{
  0%{ transform: translateX(-120%) skewX(-12deg); }
  60%{ transform: translateX(120%) skewX(-12deg); }
  100%{ transform: translateX(120%) skewX(-12deg); }
}

.final-hint{ text-align:center; color:#777; margin: 6px 0 0; font-size: .95rem; }

/* ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏≠‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å */
.gift-card.is-selected{
  transform: translateY(-2px) scale(1.03);
  box-shadow: 0 18px 34px rgba(255,105,180,.35);
}

/* ===== Gift Box Popup (cute) ===== */
.popup--box{
  background: radial-gradient(rgba(255,240,246,.65), rgba(255,255,255,.2));
  backdrop-filter: blur(6px);
}

.box-card{
  position: relative;
  max-width: 420px;
  width: calc(100% - 40px);
  padding: 24px 20px 20px;
  border-radius: 22px;
  background: linear-gradient(180deg,#ffffff,#fff6fb);
  border: 3px solid transparent;
  background-clip: padding-box;
  box-shadow: 0 14px 34px rgba(255,102,178,.28), 0 8px 18px rgba(0,0,0,.08);
  animation: pop-in .45s ease-out both;
}
.box-card::before{
  content:"";
  position:absolute; inset:-3px; border-radius:24px;
  background: linear-gradient(135deg,#ff96c8,#ffd1e8,#ffffff);
  z-index:-1;
}

.box-title{ color:#cc0077; text-align:center; margin:4px 0 6px; }
.box-sub{ color:#555; text-align:center; margin:0 0 12px; }

/* ‡∏£‡∏¥‡∏ö‡∏ö‡∏¥‡πâ‡∏ô */
.box-ribbon{
  position:absolute; top:10px; left:50%; transform:translateX(-50%);
  width: 82%; height: 28px; border-radius: 999px;
  background: linear-gradient(90deg,#ff99cc,#ff66b2);
  box-shadow: 0 8px 18px rgba(255,102,178,.35);
}
.box-ribbon::before,.box-ribbon::after{
  content:""; position:absolute; top:20px; width:18px; height:22px; border-radius:4px;
  background: linear-gradient(180deg,#ff99cc,#ff66b2);
  filter: drop-shadow(0 2px 4px rgba(0,0,0,.12));
}
.box-ribbon::before{ left:12%; transform: rotate(-12deg); }
.box-ribbon::after{ right:12%; transform: rotate(12deg); }

/* ‡∏ï‡∏£‡∏≤‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡∏´‡∏±‡∏ß‡πÉ‡∏à */
.box-stamp{
  position:absolute; right:12px; top:12px; font-size:28px;
  transform: rotate(-14deg);
  text-shadow: 0 2px 0 rgba(0,0,0,.08);
}

/* ‡πÅ‡∏™‡∏á‡∏ß‡∏¥‡πâ‡∏á */
.box-shine{
  position:absolute; inset:0; pointer-events:none;
  background: linear-gradient(110deg, rgba(255,255,255,.0) 10%, rgba(255,255,255,.35) 35%, rgba(255,255,255,.0) 60%);
  transform: translateX(-120%) skewX(-12deg);
  animation: shine-sweep 4s ease-in-out infinite;
}

.box-img{
  width: 70%;
  height: auto;
  display:block;
  margin: 8px auto 12px;
  border-radius: 14px;
  box-shadow: 0 8px 16px rgba(0,0,0,.08);
}

/* ‡∏õ‡∏∏‡πà‡∏° */
.box-actions{ display:flex; gap:10px; justify-content:center; flex-wrap:wrap; }
.btn-primary{
  padding: 12px 22px; border:none; border-radius:999px;
  background: linear-gradient(45deg,#ff99cc,#ff66b2);
  color:#fff; font-size:1rem; cursor:pointer;
  box-shadow: 0 8px 18px rgba(255,102,178,.35);
  transition: transform .15s, box-shadow .2s;
  animation: pulse 1.6s ease-in-out infinite;
}
.btn-primary:hover{ transform: translateY(-1px) scale(1.03); box-shadow: 0 12px 24px rgba(255,102,178,.45); }

.btn-ghost{
  padding: 11px 18px; border-radius:999px; border:2px solid #ffd1e8; background:#fff;
  color:#a80062; cursor:pointer; transition: transform .15s, box-shadow .2s;
}
.btn-ghost:hover{ transform: translateY(-1px); box-shadow: 0 8px 18px rgba(0,0,0,.08); }

/* ‡∏™‡∏õ‡∏≤‡∏£‡πå‡∏Å‡πÄ‡∏Ñ‡∏¥‡∏•‡∏•‡∏≠‡∏¢ */
.box-sparkle{
  position:absolute; width:7px; height:7px; border-radius:50%;
  background: radial-gradient(#fff,#ffd1e8);
  pointer-events:none; opacity:.95;
  animation: sparkle-float 2s ease-out forwards;
}

/* keyframes reuse */
@keyframes pop-in{ from{ transform:translateY(6px) scale(.98); opacity:0; } to{ transform:translateY(0) scale(1); opacity:1; } }
@keyframes shine-sweep{ 0%{ transform: translateX(-120%) skewX(-12deg);} 60%{ transform: translateX(120%) skewX(-12deg);} 100%{ transform: translateX(120%) skewX(-12deg);} }
@keyframes sparkle-float{ to{ transform: translateY(-46px) translateX(var(--dx)); opacity:0; } }

/* ===== Gift Card Popup (cute) ===== */
.popup--card{
  background: radial-gradient(rgba(255,240,246,.65), rgba(255,255,255,.2));
  backdrop-filter: blur(6px);
}

/* ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏Ñ‡∏õ‡∏Ø */
.card-canvas{
  position: relative;
  margin: 0 auto 10px;
  padding: 20px 18px;
  border-radius: 18px;
  background: linear-gradient(180deg,#ffffff,#fff8fb);
  border: 2px dashed #ffd1e8;                /* ‡∏Ç‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î */
  box-shadow: 0 10px 24px rgba(255,102,178,.18), inset 0 2px 8px rgba(255,255,255,.8);
  max-width: min(92vw, 420px);
}

/* ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏≤‡∏£‡πå‡∏î */
.card-title{
  font-family: "Mitr", "Sarabun", sans-serif;
  color:#cc0077;
  text-align:center;
  margin: 4px 0 8px;
  font-size: 1.5rem;         /* ‡πÇ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î */
  font-weight: 700;
  letter-spacing: .2px;
}

/* GIF ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏° */
.card-gif{
  display:block;
  width: min(80vw, 260px);     /* ‡πÄ‡∏î‡∏¥‡∏° ~360px ‚Üí ‡∏¢‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏≠‡∏î‡∏µ */
  height: auto;
  margin: 0 auto 10px;
  border-radius: 14px;
  border: 4px solid #fff;
  box-shadow: 0 8px 20px rgba(0,0,0,.12);
  animation: gentle-bounce 2.2s ease-in-out infinite;
}

/* ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏ß‡∏¢‡∏û‡∏£ */
.card-message{
  color:#555;
  text-align:center;
  margin: 8px auto 0;
  font-size: 1.02rem;
  line-height: 1.55;
  max-width: 36ch;
  white-space: pre-line;
}

/* ‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏°‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πå‡∏î (‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢) */
.card-canvas::before,
.card-canvas::after{
  content:"";
  position:absolute;
  width: 18px; height: 18px;
  border-radius: 4px;
  background: radial-gradient(#fff,#ffe6f2);
  box-shadow: 0 4px 12px rgba(255,102,178,.25);
}
.card-canvas::before{ top:10px; left:10px; transform: rotate(12deg); }
.card-canvas::after{ bottom:10px; right:10px; transform: rotate(-12deg); }


.card-wrap{
  position: relative;
  max-width: 480px;
  width: calc(100% - 40px);
  padding: 26px 20px 20px;
  border-radius: 24px;
  background: linear-gradient(180deg,#ffffff,#fff6fb);
  border: 3px solid transparent;
  background-clip: padding-box;
  box-shadow: 0 16px 36px rgba(255,102,178,.25), 0 8px 18px rgba(0,0,0,.08);
  animation: pop-in .45s ease-out both;
}
.card-wrap::before{
  content:"";
  position:absolute; inset:-3px; border-radius:26px;
  background: linear-gradient(135deg,#ff96c8,#ffd1e8,#ffffff);
  z-index:-1;
}


.card-actions{
  display:flex; gap:10px; justify-content:center; flex-wrap:wrap;
}

.btn-primary{
  padding: 12px 22px; border:none; border-radius:999px;
  background: linear-gradient(45deg,#ff99cc,#ff66b2);
  color:#fff; font-size:1rem; cursor:pointer;
  box-shadow: 0 8px 18px rgba(255,102,178,.35);
  transition: transform .15s ease, box-shadow .2s ease;
  animation: pulse 1.6s ease-in-out infinite;
  text-decoration: none; display:inline-block;
}
.btn-primary:hover{ transform: translateY(-1px) scale(1.03); box-shadow: 0 12px 24px rgba(255,102,178,.45); }

.btn-ghost{
  padding: 11px 18px; border-radius:999px; border:2px solid #ffd1e8; background:#fff;
  color:#a80062; cursor:pointer; transition: transform .15s ease, box-shadow .2s ease;
}
.btn-ghost:hover{ transform: translateY(-1px); box-shadow: 0 8px 18px rgba(0,0,0,.08); }

/* ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö */
.card-badge{
  position:relative;
  width:94px; height:94px; margin:-64px auto 6px;
  filter: drop-shadow(0 8px 14px rgba(255,102,178,.28));
}
.badge-ring{
  position:absolute; inset:0; border-radius:50%;
  background: conic-gradient(from 0deg,#ff79bd,#ffd1e8,#fff,#ff79bd);
}
.badge-core{
  position:absolute; inset:10px; border-radius:50%;
  display:grid; place-items:center;
  background: radial-gradient(#fff,#ffe6f2);
  font-size: 30px;
}

.card-ribbon{
  position:absolute; top:10px; left:50%; transform:translateX(-50%);
  width: 86%; height: 28px; border-radius: 999px;
  background: linear-gradient(90deg,#ff99cc,#ff66b2);
  box-shadow: 0 8px 18px rgba(255,102,178,.35);
}
.card-ribbon::before,.card-ribbon::after{
  content:""; position:absolute; top:20px; width:18px; height:22px; border-radius:4px;
  background: linear-gradient(180deg,#ff99cc,#ff66b2);
  filter: drop-shadow(0 2px 4px rgba(0,0,0,.12));
}
.card-ribbon::before{ left:12%; transform: rotate(-12deg); }
.card-ribbon::after{ right:12%; transform: rotate(12deg); }

.card-shine{
  position:absolute; inset:0; pointer-events:none;
  background: linear-gradient(110deg, rgba(255,255,255,.0) 10%, rgba(255,255,255,.35) 35%, rgba(255,255,255,.0) 60%);
  transform: translateX(-120%) skewX(-12deg);
  animation: shine-sweep 4s ease-in-out infinite;
}

/* ‡∏™‡∏õ‡∏≤‡∏£‡πå‡∏Å‡πÄ‡∏Ñ‡∏¥‡∏•‡∏•‡∏≠‡∏¢ */
.card-sparkle{
  position:absolute; width:7px; height:7px; border-radius:50%;
  background: radial-gradient(#fff,#ffd1e8);
  pointer-events:none; opacity:.95;
  animation: sparkle-float 2s ease-out forwards;
}

/* keyframes reuse */
@keyframes pop-in{ from{ transform:translateY(6px) scale(.98); opacity:0; } to{ transform:translateY(0) scale(1); opacity:1; } }
@keyframes spin{ to{ transform: rotate(360deg); } }
@keyframes shine-sweep{ 0%{ transform: translateX(-120%) skewX(-12deg);} 60%{ transform: translateX(120%) skewX(-12deg);} 100%{ transform: translateX(120%) skewX(-12deg);} }
@keyframes sparkle-float{ to{ transform: translateY(-46px) translateX(var(--dx)); opacity:0; } }
@keyframes gentle-bounce{
  0%,100%{ transform: translateY(0); }
  50%{ transform: translateY(-4px); }
}

.card-subtitle{
  font-family: "Sarabun", sans-serif;
  text-align: center;
  margin: 6px auto 6px;
  font-size: 1.1rem;           /* ‡πÄ‡∏•‡πá‡∏Å‡∏Å‡∏ß‡πà‡∏≤ .card-title */
  font-weight: 600;
  letter-spacing: .2px;
  max-width: 36ch;
}
.card-subtitle .sub-label {
  font-family: "Sarabun", sans-serif;
  color: #a80062;              /* ‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏°‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏¥‡∏î */
  margin-right: .35ch;
}
.card-subtitle .sub-value{
  font-family: "Sarabun", sans-serif;
  color: #a80062;              /* ‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏°‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏¥‡∏î */
  margin-right: .35ch;
}

.card-subnote{
  font-family: "Sarabun", sans-serif;
  text-align: center;
  margin: 2px auto 8px;
  color: #a80062;
  opacity: .80;           /* ‡∏≠‡πà‡∏≠‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏´‡∏•‡∏±‡∏Å */
  font-size: 1.1rem;      /* ‡πÄ‡∏•‡πá‡∏Å‡∏Å‡∏ß‡πà‡∏≤ "‡∏Ñ‡∏∑‡∏≠‚Ä¶" (1.1rem) */
  font-weight: 600;
  letter-spacing: .2px;
  max-width: 36ch;
}

/* ‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏î‡∏π‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏°‡∏Ç‡∏∂‡πâ‡∏ô + ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡πÑ‡∏ß‡πâ‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î */
.card-canvas{
  position: relative;
  overflow: hidden;                 /* ‡∏Å‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏•‡πâ‡∏ô‡∏Å‡∏£‡∏≠‡∏ö */
  background: linear-gradient(180deg,#ffffff,#fff8fb);
  border-radius: 20px;
  border: 2px dashed #ffd1e8;
  padding: 22px 18px 18px;
}

/* ‡∏•‡∏≤‡∏¢‡∏•‡∏∞‡∏°‡∏∏‡∏ô‡∏ö‡∏≤‡∏á‡πÜ ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÉ‡∏ô‡∏Å‡∏£‡∏≠‡∏ö (‡∏à‡∏±‡∏ö‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô) */
.card-canvas::before{
  content:"";
  position:absolute; inset:0; pointer-events:none;
  background:
    radial-gradient(12px 12px at 10% 15%, rgba(255,204,230,.22) 0 40%, transparent 45%) ,
    radial-gradient(10px 10px at 80% 30%, rgba(255,204,230,.18) 0 40%, transparent 45%),
    radial-gradient(12px 12px at 25% 80%, rgba(255,204,230,.20) 0 40%, transparent 45%);
  opacity:.6;
}

/* ‡∏£‡∏¥‡∏ö‡∏ö‡∏¥‡πâ‡∏ô‡πÑ‡∏•‡πà‡∏™‡∏µ‡πÉ‡∏ï‡πâ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ (‡πÉ‡∏ä‡πâ‡πÄ‡∏™‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡πÅ‡∏ö‡∏ö pill) */
.card-title{
  position: relative;
  padding-bottom: 6px;
}
.card-title::after{
  content:"";
  position:absolute; left:50%; transform:translateX(-50%);
  bottom:-2px; width: 180px; height: 10px; border-radius: 999px;
  background: linear-gradient(90deg,#ff9acb,#ff66b2);
  filter: blur(0.3px) drop-shadow(0 4px 8px rgba(255,102,178,.25));
}

/* ‡∏ä‡∏¥‡∏õ‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡πÉ‡∏ï‡πâ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ */
.cc-chips{
  display:flex; gap:6px; justify-content:center; flex-wrap:wrap;
  margin: 4px 0 2px;
}
.cc-chip{
  background:#ffe6f2; color:#a80062;
  padding: 4px 10px;
  border-radius: 999px;
  font-size: .85rem;
  box-shadow: 0 4px 10px rgba(255,102,178,.15), inset 0 2px 6px rgba(255,255,255,.9);
}

/* ‡πÄ‡∏™‡πâ‡∏ô‡∏Ñ‡∏±‡πà‡∏ô‡∏´‡∏±‡∏ß‡πÉ‡∏à */
.cc-divider{
  position: relative;
  display: grid; place-items: center;
  margin: 8px auto 2px; width: 100%; max-width: 360px; height: 14px;
}
.cc-divider::before{
  content:""; position:absolute; left: 16px; right:16px; top:50%;
  height: 2px; transform: translateY(-50%);
  background: linear-gradient(90deg, transparent, #ffd1e8, transparent);
}
.cc-heart{
  position: relative; z-index:1;
  display:inline-block; padding: 0 10px;
  color:#cc0077; font-size: .95rem;
  box-shadow: 0 2px 8px rgba(255,102,178,.18);
}

/* ‡∏£‡∏∞‡∏¢‡∏¥‡∏ö‡∏£‡∏∞‡∏¢‡∏±‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏£‡∏≠‡∏ö */
.cc-sparkles{ position:absolute; inset:0; pointer-events:none; }
.cc-sparkles span{
  position:absolute; width:7px; height:7px; border-radius:50%;
  background: radial-gradient(#fff,#ffd1e8);
  opacity:.9; animation: cc-float 3.2s ease-in-out infinite;
}
@keyframes cc-float{
  0%,100%{ transform: translateY(0) scale(1); opacity:.9; }
  50%{ transform: translateY(-10px) scale(0.95); opacity:.75; }
}
/* ‡πÄ‡∏•‡∏¢‡πå‡πÄ‡∏≠‡∏≤‡∏ï‡πå‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏™‡∏õ‡∏≤‡∏£‡πå‡∏Å‡πÄ‡∏Ñ‡∏¥‡∏• */
.cc-sparkles span:nth-child(1){ left:8%;  top:10%; animation-delay:.1s; }
.cc-sparkles span:nth-child(2){ left:78%; top:16%; animation-delay:.4s; }
.cc-sparkles span:nth-child(3){ left:14%; top:58%; animation-delay:.2s; }
.cc-sparkles span:nth-child(4){ left:86%; top:66%; animation-delay:.6s; }
.cc-sparkles span:nth-child(5){ left:28%; top:28%; animation-delay:.8s; }
.cc-sparkles span:nth-child(6){ left:64%; top:40%; animation-delay:.3s; }
.cc-sparkles span:nth-child(7){ left:38%; top:78%; animation-delay:1.0s; }
.cc-sparkles span:nth-child(8){ left:52%; top:16%; animation-delay:1.2s; }

/* ‡∏ü‡∏∏‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏•‡πá‡∏Å‡πÜ */
.cc-footer{
  display:flex; gap:8px; justify-content:center; align-items:center;
  margin-top: 8px; color:#a80062; opacity:.8; font-size:.92rem;
}
.cc-dot{ opacity:.6; }
.cc-tag{
  background:#fff; border:1px solid #ffd1e8; border-radius:999px;
  padding: 3px 10px; box-shadow: 0 3px 10px rgba(255,102,178,.12);
}

/* (‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß) ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î GIF ‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ ‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏¢‡πà‡∏≠‡∏¢ */
.card-gif{ width: min(80vw, 260px); }
.card-subtitle{ font-size: 1.1rem; }
.card-subnote{ font-size: 1.0rem; opacity:.80; }
.card-subtitle .sub-label{ color:#a80062; }
.card-subtitle .sub-value{ color:#a80062; opacity:.75; }

/* ==== Compact size for gift card popup (shrink ~12‚Äì15%) ==== */
#giftCardPopup .popup-content.card-wrap{
  width: min(90vw, 400px);        /* ‡πÄ‡∏î‡∏¥‡∏° ~520px */
  padding: 18px 16px 16px;        /* ‡πÄ‡∏î‡∏¥‡∏°‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
}

#giftCardPopup .card-canvas{
  max-width: min(88vw, 360px);    /* ‡πÄ‡∏î‡∏¥‡∏° ~420px */
  padding: 16px 14px 14px;        /* ‡∏•‡∏î padding ‡∏•‡∏á‡∏ô‡∏¥‡∏î */
  border-radius: 18px;
}

/* ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‚Äì ‡∏•‡∏î‡∏•‡∏á‡∏ó‡∏µ‡∏•‡∏∞‡∏ô‡∏¥‡∏î */
#giftCardPopup .card-title{ font-size: 1.25rem; }     /* ‡πÄ‡∏î‡∏¥‡∏° ~1.35rem */
#giftCardPopup .card-subtitle{ font-size: 1.00rem; }  /* ‡πÄ‡∏î‡∏¥‡∏° 1.1rem */
#giftCardPopup .card-subnote{ font-size: 0.95rem; }   /* ‡πÄ‡∏î‡∏¥‡∏° 1.0rem */
#giftCardPopup .card-message{ font-size: 0.98rem; }   /* ‡πÄ‡∏î‡∏¥‡∏° ~1.05rem */

/* GIF ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á‡∏≠‡∏µ‡∏Å‡∏´‡∏ô‡πà‡∏≠‡∏¢ */
#giftCardPopup .card-gif{
  width: min(70vw, 210px);        /* ‡πÄ‡∏î‡∏¥‡∏° ~260px */
  margin-bottom: 8px;
}

/* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏à‡∏∏‡∏Å‡∏à‡∏¥‡∏Å‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö */
#giftCardPopup .cc-chips{ gap: 6px; margin: 4px 0 2px; }
#giftCardPopup .cc-chip{ padding: 3px 8px; font-size: .8rem; }
#giftCardPopup .cc-divider{ margin: 6px auto 2px; max-width: 320px; }
#giftCardPopup .cc-footer{ margin-top: 6px; font-size: .88rem; gap: 6px; }

/* ‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á‡∏ô‡∏¥‡∏î ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏≤‡∏•‡∏≤‡∏ô‡∏ã‡πå‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏ß‡∏° */
#giftCardPopup .card-actions .btn-primary,
#giftCardPopup .card-actions .btn-ghost{
  padding: 10px 18px;
  font-size: .95rem;
}
/* Scale-down visually while keeping layout robust */
#giftCardPopup .popup-content.card-wrap{
  transform: scale(.80);              /* ‡∏õ‡∏£‡∏±‡∏ö .85-.92 ‡∏ï‡∏≤‡∏°‡∏ä‡∏≠‡∏ö */
  transform-origin: top center;
  width: min(88vw, 460px);            /* ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏´‡∏•‡∏±‡∏á‡∏™‡πÄ‡∏Å‡∏• */
  margin: 20px auto;
}

/* ===== Hero (‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å) ‡∏™‡∏ß‡∏¢ ‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å ‡∏™‡∏î‡πÉ‡∏™ ===== */
#mainPage{
  position: relative;
  padding: 24px 16px;
}

/* ‡∏•‡∏∞‡∏°‡∏∏‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏ö‡∏ö‡πÄ‡∏ö‡∏≤ ‡πÜ ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô */
#mainPage::before{
  content:"";
  position:absolute; inset:0; pointer-events:none;
  background:
    radial-gradient(16rem 12rem at 18% 20%, rgba(255,204,230,.28), transparent 60%),
    radial-gradient(18rem 14rem at 82% 30%, rgba(255,204,230,.22), transparent 65%),
    radial-gradient(20rem 16rem at 50% 85%, rgba(255,204,230,.20), transparent 70%);
  z-index: 0;
}

/* ‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÉ‡∏™ ‡πÜ ‡∏£‡∏ß‡∏°‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠/‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°/‡∏õ‡∏∏‡πà‡∏° */
.hero-card{
  position: relative;
  z-index: 1;
  width: min(92vw, 560px);
  padding: 22px 20px 18px;
  border-radius: 24px;
  background: linear-gradient(180deg,#ffffffcc,#fff6fbcc);
  border: 2px solid #ffd1e8;
  box-shadow: 0 16px 36px rgba(255,102,178,.20), 0 8px 18px rgba(0,0,0,.06);
  backdrop-filter: blur(6px);
  text-align: center;
}

/* ‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå: ‡∏ß‡∏á‡πÅ‡∏´‡∏ß‡∏ô‡∏ä‡∏°‡∏û‡∏π + ‡∏•‡∏≠‡∏¢‡∏ô‡∏¥‡∏î ‡πÜ */
.hero-photo{
  box-shadow: 0 10px 24px rgba(0,0,0,.12);
  border: 5px solid #fff;
  position: relative;
  animation: hero-float 3.5s ease-in-out infinite;
}
.hero-photo::after{ /* ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏ö‡∏≤‡∏á‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö pseudo ‡∏ö‡∏ô img ‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏õ‡πÑ‡∏î‡πâ */
  content: "";
}

@keyframes hero-float{
  0%,100%{ transform: translateY(0); }
  50%{ transform: translateY(-6px); }
}

/* ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ò‡∏µ‡∏°‡∏Å‡∏≤‡∏£‡πå‡∏î */
.hero-title{
  margin: .25rem 0;
  color: #cc0077;
  text-shadow: 0 2px 0 rgba(255,255,255,.9);
  font-size: 2.4rem;              /* ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
  letter-spacing: .3px;
}

/* ‡πÄ‡∏™‡πâ‡∏ô‡∏£‡∏¥‡∏ö‡∏ö‡∏¥‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÅ‡∏ñ‡∏ß‡∏•‡πà‡∏≤‡∏á */

.hero-title:last-of-type::after{
  content:"";
  position:absolute; left:50%; transform:translateX(-50%);
  bottom:-2px; width: 200px; height: 10px; border-radius: 999px;
  background: linear-gradient(90deg,#ff9acb,#ff66b2);
  filter: drop-shadow(0 4px 8px rgba(255,102,178,.25));
}

/* ‡∏ä‡∏¥‡∏õ‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å (‡∏£‡∏µ‡πÉ‡∏ä‡πâ .chip ‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢) */
.hero-chips{
  display:flex; justify-content:center; gap:8px; flex-wrap:wrap;
  margin: 6px 0 4px;
}

/* ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏ó‡∏õ‡πå‡πÑ‡∏£‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÉ‡∏´‡πâ balance ‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î */
.hero-subnote{
  margin-top: 6px;
  color: #273050;
  font-size: 1.1rem;   /* ‡∏≠‡πà‡∏≤‡∏ô‡∏™‡∏ö‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô */
  text-shadow: 0 1px 0 rgba(255,255,255,.9);
}

/* ‡πÄ‡∏™‡πâ‡∏ô‡∏Ñ‡∏±‡πà‡∏ô‡∏´‡∏±‡∏ß‡πÉ‡∏à‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î */
.hero-divider{
  position: relative; display:grid; place-items:center;
  width: 100%; max-width: 420px; height: 16px; margin: 10px auto 4px;
}
.hero-divider::before{
  content:""; position:absolute; left: 16px; right:16px; top:50%;
  height: 2px; transform: translateY(-50%);
  background: linear-gradient(90deg, transparent, #ffd1e8, transparent);
}
.hero-divider span{
  position: relative; z-index:1; background:#fff; border-radius:999px;
  padding: 0 10px; color:#cc0077; font-size: .95rem;
  box-shadow: 0 2px 8px rgba(255,102,178,.18);
}

/* ‡∏õ‡∏∏‡πà‡∏°: ‡πÄ‡∏á‡∏≤‡∏ß‡∏¥‡πâ‡∏á‡∏Å‡πå‡∏ß‡∏¥‡πâ‡∏á + ‡∏Ç‡∏ô‡∏≤‡∏î‡∏û‡∏≠‡∏î‡∏µ‡∏°‡∏∑‡∏≠ */
.hero-cta{
  position: relative;
  margin-top: 12px;
  padding: 14px 28px;
  border-radius: 999px;
}
.hero-cta::after{
  content:"";
  position:absolute; inset:0; pointer-events:none;
  background: linear-gradient(110deg, rgba(255,255,255,0) 10%, rgba(255,255,255,.45) 35%, rgba(255,255,255,0) 60%);
  transform: translateX(-120%) skewX(-12deg);
  animation: hero-shine 3.2s ease-in-out infinite;
  border-radius: inherit;
}
@keyframes hero-shine{
  0%{ transform: translateX(-120%) skewX(-12deg); }
  60%{ transform: translateX(120%)  skewX(-12deg); }
  100%{ transform: translateX(120%)  skewX(-12deg); }
}

/* ‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å */
@media (max-width: 420px){
  .hero-title{ font-size: 2.1rem; }
  .hero-card{ padding: 18px 16px; width: min(94vw, 560px); }
}


#giftCardPopup.is-30{
  overflow-y: auto;
  padding: 16px;
  -webkit-overflow-scrolling: touch;
}

/* ‡∏à‡∏±‡∏î #mainPage (‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô hero-card) ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏•‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤ */
#mainPage{
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;          /* ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á */
  min-height: 100vh;                /* ‡πÄ‡∏ï‡πá‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ */
  min-height: 100dvh;               /* ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ö‡∏ö‡∏ô/‡∏•‡πà‡∏≤‡∏á‡∏¢‡∏∑‡∏î‡∏´‡∏î */
  padding: 24px 16px;
  box-sizing: border-box;
  margin: 0 auto;                   /* ‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
}

/* ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ */
#mainPage.hero-card{
  width: min(92vw, 560px);
}

/* QR ‡∏°‡∏∏‡∏°‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤ ‡πÉ‡∏ô‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î */
.cc-qr{
  position: absolute;
  right: 8px;
  bottom: 8px;
  display: grid;
  justify-items: center;
  text-decoration: none;
  gap: 3px;
  z-index: 2;
}

.cc-qr img{
  width: 40px;        /* ‡∏õ‡∏£‡∏±‡∏ö 56‚Äì96 ‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ä‡∏≠‡∏ö */
  height: 40px;
  background: #fff;   /* ‡∏Ç‡∏≤‡∏ß‡∏ï‡∏±‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á */
  border: 2px solid #ffd1e8;/* ‡∏Å‡∏£‡∏≠‡∏ö‡∏ä‡∏°‡∏û‡∏π‡∏≠‡πà‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πà‡∏ô ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏´‡∏ô‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô */
  border-radius: 6px;
  box-shadow: 0 4px 10px rgba(0,0,0,.10);
}

.cc-qr-label{
  font-size: .72rem;
  color: #a80062;
  background: #fff;
  border: 1px solid #ffd1e8;
  border-radius: 999px;
  padding: 2px 6px;
  box-shadow: 0 3px 8px rgba(255,102,178,.12);
  line-height: 1;
}

/* ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å‡∏°‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏•‡∏î‡∏•‡∏á‡∏ô‡∏¥‡∏î */
@media (max-width: 380px){
  .cc-qr img{ width: 60px; height: 60px; }
}




  </style>
</head>
<body>
    <div class="hero-card"id="mainPage">
  <img src="https://i.postimg.cc/brZ9s3Bh/S-7790595.jpg" alt="My Love" class="photo hero-photo" />
    
    <h1 class="hero-title">Happy Birthday</h1>
  <h1 class="hero-title">My Love</h1>

  <!-- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏ó‡∏õ‡πå‡πÑ‡∏£‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏¥‡∏° (‡∏Ñ‡∏á id ‡πÄ‡∏î‡∏¥‡∏°) -->
  <p class="typewriter hero-subnote" id="typewriterText">‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÑ‡∏´‡∏° ‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏™‡∏∏‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏£‡∏≠‡πÄ‡∏ò‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏∞‚Ä¶</p>

  <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏¥‡∏° ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏•‡∏≤‡∏™ hero-cta ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏ï‡πà‡∏á‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå -->
  <button id="giftBtn" class="hero-cta"> ‡πÄ‡∏õ‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç üíå </button>
</div>

  <button id="toggleMusicBtn" style="
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 999;
  padding: 10px 20px;
  background: linear-gradient(45deg, #ff99cc, #ff66b2);
  color: white;
  border: none;
  border-radius: 20px;
  font-size: 1rem;
  cursor: pointer;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
">üîà </button>

<!-- Popup ‡∏ã‡∏≠‡∏á‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢ (‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏™‡∏î‡πÉ‡∏™) -->
<div id="letterPopup" class="popup popup--letter hidden" aria-modal="true" role="dialog" aria-labelledby="letterTitle">
  <div class="popup-content letter-card">

    <div class="letter-envelope">
      <img src="https://i.postimg.cc/wTxjKndP/letter.png" alt="‡∏ã‡∏≠‡∏á‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢" class="letter-icon" />
    </div>

    <h2 id="letterTitle">‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡πä‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å</h2>
    <p class="letter-text">
      ‡πÄ‡∏Ñ‡πâ‡∏≤‡∏°‡∏µ‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏ò‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡∏Å‡∏î‡πÄ‡∏•‡∏¢!
    </p>

    <button class="letter-cta" onclick="startMemoryPuzzle()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏•‡∏¢ </button>
  </div>
</div>


  
  <!-- Popup ‡∏ä‡∏ô‡∏∞‡πÄ‡∏Å‡∏° (‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏™‡∏î‡πÉ‡∏™) -->
<div id="popupSuccess" class="popup popup--success hidden" aria-modal="true" role="dialog" aria-labelledby="successTitle">
  <div class="popup-content success-card">
    <div class="success-badge" aria-hidden="true">
      <div class="badge-ring"></div>
      <div class="badge-core">üéâ</div>
    </div>

    <h2 id="successTitle" class="success-title">‡πÄ‡∏¢‡πà! ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å</h2>
    <p class="success-text">
      ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏†‡∏≤‡∏û‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡πä‡∏≤  <br>‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡πâ‡∏≤‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÑ‡∏ß‡πâ‡∏£‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡πÄ‡∏•‡πâ‡∏ß ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏∂‡∏¢‡∏±‡∏á
    </p>

    <div class="success-actions">
      <button class="btn-primary" onclick="goToFinalGame()">‡πÑ‡∏õ‡πÄ‡∏õ‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç üíå</button>
      <!-- ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏≠‡∏á ‡∏Å‡πá‡∏ï‡∏±‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ó‡∏¥‡πâ‡∏á‡πÑ‡∏î‡πâ -->
      <button class="btn-ghost" onclick="closeSuccess()">‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏Å‡πà‡∏≠‡∏ô</button>
    </div>
  </div>
</div>



  <div id="finalGame" class="center" style="display:none;">
  <div class="final-card" aria-labelledby="finalTitle">
    <div class="final-head">
      <h1 id="finalTitle" class="final-title">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏™‡∏∏‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©</h1>
      <p class="final-sub">‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏°‡∏µ‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏û‡∏£‡∏™‡πå‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡∏ô‡∏∞ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏´‡∏±‡∏ß‡πÉ‡∏à‡πÄ‡∏•‡∏¢ </p>
      <div class="final-chips">
        <span class="chip">‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°‡∏ô‡πä‡∏≤ ‡∏°‡∏≤‡∏•‡∏∏‡πâ‡∏ô‡∏Å‡∏±‡∏ôüíó</span>
      </div>
    </div>

    <div class="gift-grid-3" id="giftGrid">
      <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á 1 -->
      <button class="gift-card" data-index="0" aria-label="‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏´‡∏ô‡∏∂‡πà‡∏á">
        <img src="https://i.postimg.cc/MpMdmyDG/Chat-GPT-Image-6-2568-16-28-12.png" alt="" class="gift-img" />
        <span class="gift-shine" aria-hidden="true"></span>
      </button>

      <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á 2 -->
      <button class="gift-card" data-index="1" aria-label="‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á">
        <img src="https://i.postimg.cc/MpMdmyDG/Chat-GPT-Image-6-2568-16-28-12.png" alt="" class="gift-img" />
        <span class="gift-shine" aria-hidden="true"></span>
      </button>

      <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á 3 -->
      <button class="gift-card" data-index="2" aria-label="‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°">
        <img src="https://i.postimg.cc/MpMdmyDG/Chat-GPT-Image-6-2568-16-28-12.png" alt="" class="gift-img" />
        <span class="gift-shine" aria-hidden="true"></span>
      </button>
    </div>

    <p class="final-hint">‡πÅ‡∏ï‡∏∞/‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÉ‡∏à ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏õ‡∏•‡∏∏‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡πÄ‡∏•‡∏¢<br>(‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤!)</p>
  </div>
</div>

<!-- Popup ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏à‡∏£‡∏¥‡∏á (‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏™‡∏î‡πÉ‡∏™) -->
<div id="giftCardPopup" class="popup popup--card hidden" aria-modal="true" role="dialog" aria-labelledby="giftCardTitle">
  <div class="popup-content card-wrap">
    <!-- ‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á (‡∏Ñ‡∏á‡πÑ‡∏ß‡πâ‡πÑ‡∏î‡πâ) -->
    <div class="card-badge" aria-hidden="true">
      <div class="badge-ring"></div>
      <div class="badge-core">üíñ</div>
    </div>

    <div id="cardCanvasArea" class="card-canvas" role="group" aria-label="‡∏ö‡∏±‡∏ï‡∏£‡∏≠‡∏ß‡∏¢‡∏û‡∏£">
      <h1 id="giftCardTitle" class="card-title">Happy Birthday My Love</h1>
      <div class="cc-chips" aria-hidden="true">
    <span class="cc-chip">‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡πÄ‡∏ò‡∏≠</span>
  </div>
      <img id="giftGif" src="" alt="‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç" class="card-gif" crossorigin="anonymous" />
      <h3 id="giftSubTitle" class="card-subtitle">
        <span class="sub-label">üéâ</span>
      </h3>

      <a id="giftQRLink" class="cc-qr" href="https://www.canva.com/design/DAGvrphMl34/w44lPAbAlAfqbjG5A33Qzw/watch?utm_content=DAGvrphMl34&utm_campaign=designshare&utm_medium=link2&utm_source=uniquelinks&utlId=h332c25f8d2" target="_blank" rel="noopener">
  <img id="giftQR" alt="QR to video" crossorigin="anonymous" />
  <span class="cc-qr-label">‡∏à‡∏¥‡πâ‡∏°/‡πÅ‡∏™‡∏Å‡∏ô ‚ñ∂</span>
</a>

      <!-- ‡πÄ‡∏™‡πâ‡∏ô‡∏Ñ‡∏±‡πà‡∏ô‡∏´‡∏±‡∏ß‡πÉ‡∏à -->
  <div class="cc-divider" aria-hidden="true"><span class="cc-heart">‚ù§Ô∏é</span></div>


      <p id="giftMessage" class="card-message"></p>

      <!-- ‡∏£‡∏∞‡∏¢‡∏¥‡∏ö‡∏£‡∏∞‡∏¢‡∏±‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏£‡∏≠‡∏ö (‡∏à‡∏±‡∏ö‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Å‡∏£‡∏≠‡∏ö‡∏ô‡∏µ‡πâ) -->
  <div class="cc-sparkles" aria-hidden="true">
    <span></span><span></span><span></span><span></span>
    <span></span><span></span><span></span><span></span>
  </div>

</div>


    <!-- ‡∏õ‡∏∏‡πà‡∏° -->
    <div class="card-actions">
      <button id="saveCardBtn" class="btn-primary" type="button">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πå‡∏î ‚§ì</button>
      <button class="btn-ghost" onclick="closeGiftCard()">‡∏õ‡∏¥‡∏î</button>
    </div>
  </div>
</div>




<!-- Popup ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ä‡∏±‡πâ‡∏ô‡πÅ‡∏£‡∏Å (‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏™‡∏î‡πÉ‡∏™) -->
<div id="giftBoxPopup" class="popup popup--box hidden" aria-modal="true" role="dialog" aria-labelledby="giftBoxTitle">
  <div class="popup-content box-card">

    <h2 id="giftBoxTitle" class="box-title">‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡πä‡∏≤</h2>
    <p class="box-sub">‡∏≠‡∏¢‡∏≤‡∏Å‡∏£‡∏π‡πâ‡πÑ‡∏´‡∏°‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£? ‡∏•‡∏∏‡πâ‡∏ô‡πÄ‡∏•‡∏¢ </p>

    <img id="selectedBoxImg" src="" alt="‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å" class="box-img" />

    <div class="box-actions">
      <button class="btn-primary" onclick="revealGift()">‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏•‡∏¢üíå</button>
    </div>
  </div>
</div>






  
  <!-- ‡∏ß‡∏≤‡∏á‡πÅ‡∏ó‡∏ô‡∏™‡πà‡∏ß‡∏ô <script> ‡πÄ‡∏î‡∏¥‡∏° -->
<script>
  const giftBtn = document.getElementById("giftBtn");
  const mainPage = document.getElementById("mainPage");
  const colors = ['#ffc0cb', '#ffb6c1', '#ff69b4', '#f08080', '#ffa07a', '#ffd1dc'];
  const openGiftSound = new Audio("https://www.soundjay.com/buttons/sounds/button-09a.mp3");
  openGiftSound.volume = 0.02; // ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏á‡∏ï‡∏≤‡∏°‡πÉ‡∏à

  
  const bgMusic = new Audio("https://www.bensound.com/bensound-music/bensound-love.mp3"); // üîÅ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡πÑ‡∏î‡πâ
bgMusic.loop = true;
bgMusic.volume = 0.5;

let isMusicPlaying = true;
const toggleMusicBtn = document.getElementById("toggleMusicBtn");

toggleMusicBtn.addEventListener("click", async () => {
  if (isMusicPlaying) {
    bgMusic.pause();
    toggleMusicBtn.textContent = "üîá";
  } else {
    try { await bgMusic.play(); toggleMusicBtn.textContent = "üîà"; } catch(e) {}
  }
  isMusicPlaying = !isMusicPlaying;
});



  // ‚ñ∂Ô∏è ‡πÄ‡∏û‡∏¥‡πà‡∏° div ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡∏°
  const puzzlePage = document.createElement("div");
  puzzlePage.className = "center";
  puzzlePage.style.display = "none";
  document.body.appendChild(puzzlePage);

  // ‡∏•‡∏ö bgMusic.play() ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏≠‡∏≠‡∏Å
// ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏õ‡πÄ‡∏•‡πà‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏ó‡∏ô
giftBtn.addEventListener("click", () => {
  try { bgMusic.play(); } catch(e) {}
  openGiftSound.play();
  mainPage.style.visibility = "hidden";
  mainPage.style.opacity = "0";
  launchHearts(15);
  showLetterPopup();                    // << ‡πÉ‡∏ä‡πâ‡∏≠‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏ó‡∏ô remove('hidden')
});
let sparkleInterval = null;

function showLetterPopup() {
  const popup = document.getElementById("letterPopup");
  popup.classList.remove("hidden");

  const card = popup.querySelector(".letter-card");
  
  // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏•‡∏π‡∏õ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏õ‡∏≤‡∏£‡πå‡∏Å‡πÄ‡∏Ñ‡∏¥‡∏•‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢ ‡πÜ
  startSparklesLoop(card, 8, 500); 
}
let successSparklesTimer = null;

function showSuccessPopup(){
  const popup = document.getElementById("popupSuccess");
  const card  = popup.querySelector(".success-card");
  popup.classList.remove("hidden");


  // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏õ‡∏≤‡∏£‡πå‡∏Å‡πÄ‡∏Ñ‡∏¥‡∏•‡∏ß‡∏ô
  startSuccessSparkles(card);
}

function closeSuccess(){
  const popup = document.getElementById("popupSuccess");
  popup.classList.add("hidden");
  stopSuccessSparkles();
}

function startSuccessSparkles(target, count=8, everyMs=600){
  stopSuccessSparkles();
  successSparklesTimer = setInterval(() => {
    for (let i=0;i<count;i++){
      const s = document.createElement('span');
      s.className = 'success-sparkle';
      s.style.left = (Math.random()* (target.offsetWidth - 16) + 8) + 'px';
      s.style.top  = (Math.random()* (target.offsetHeight - 24) + 12) + 'px';
      s.style.setProperty('--dx', (Math.random()*70 - 35) + 'px');
      target.appendChild(s);
      setTimeout(()=> s.remove(), 2000);
    }
  }, everyMs);
}
function stopSuccessSparkles(){
  if (successSparklesTimer){
    clearInterval(successSparklesTimer);
    successSparklesTimer = null;
  }
}


function startSparklesLoop(target, count = 6, intervalMs = 600) {
  // ‡∏´‡∏¢‡∏∏‡∏î‡∏•‡∏π‡∏õ‡πÄ‡∏î‡∏¥‡∏°‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
  stopSparklesLoop();
  
  sparkleInterval = setInterval(() => {
    for (let i = 0; i < count; i++) {
      const s = document.createElement('span');
      s.className = 'sparkle';
      s.style.left = (Math.random() * target.offsetWidth) + 'px';
      s.style.top  = (Math.random() * target.offsetHeight) + 'px';
      s.style.setProperty('--dx', (Math.random() * 60 - 30) + 'px');
      target.appendChild(s);
      setTimeout(() => s.remove(), 2000);
    }
  }, intervalMs);
}

function stopSparklesLoop() {
  if (sparkleInterval) {
    clearInterval(sparkleInterval);
    sparkleInterval = null;
  }
}

// ‡∏ñ‡πâ‡∏≤‡∏à‡∏∞‡∏°‡∏µ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏¥‡∏î popup
function closeLetterPopup() {
  document.getElementById("letterPopup").classList.add("hidden");
  stopSparklesLoop();
}


function closeLetterPopup() {
  document.getElementById("letterPopup").classList.add("hidden");
}

function burstSparkles(target, n = 16) {
  const rect = target.getBoundingClientRect();
  for (let i = 0; i < n; i++) {
    const s = document.createElement('span');
    s.className = 'sparkle';
    s.style.left = (Math.random() * rect.width * 0.8 + rect.width * 0.1) + 'px';
    s.style.top  = (Math.random() * rect.height * 0.5 + rect.height * 0.1) + 'px';
    s.style.setProperty('--dx', (Math.random() * 60 - 30) + 'px');
    target.appendChild(s);
    setTimeout(() => s.remove(), 1600);
  }
}




function startMemoryPuzzle() {
  document.getElementById("letterPopup").classList.add("hidden");
  mainPage.style.display = "none"; // ‚è≥ ‡∏ã‡πà‡∏≠‡∏ô‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏Å‡∏°
  loadPuzzleGame();
}





  function launchHearts(count) {
    for (let i = 0; i < count; i++) {
      const heart = document.createElement("div");
      heart.className = "heart";
      heart.style.left = Math.random() * 100 + "vw";
      heart.style.top = Math.random() * 100 + "vh";
      heart.style.background = colors[Math.floor(Math.random() * colors.length)];
      document.body.appendChild(heart);
      setTimeout(() => heart.remove(), 15000);
    }
  }
  
  function goToFinalGame() {
  document.getElementById("popupSuccess").style.display = "none";
  puzzlePage.style.display = "none"; // ‚¨Ö ‡∏ã‡πà‡∏≠‡∏ô‡πÄ‡∏Å‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏†‡∏≤‡∏û
  document.getElementById("finalGame").style.display = "flex";
}



  setInterval(() => {
    const heart = document.createElement("div");
    heart.classList.add("heart");
    heart.style.left = Math.random() * 100 + "vw";
    heart.style.background = colors[Math.floor(Math.random() * colors.length)];
    document.body.appendChild(heart);
    setTimeout(() => heart.remove(), 15000);
  }, 700);

  const PREVIEW_MAX = 1; // ‡∏Å‡∏î‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏Å‡∏°

  // ‚úÖ Memory Puzzle
  function loadPuzzleGame() {
  // ‡πÇ‡∏Ñ‡∏£‡∏á UI ‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å
  puzzlePage.innerHTML = `
    <div class="puzzle-card" id="pCard">
      <div class="puzzle-head">
        <h1 class="puzzle-title">‡πÄ‡∏Å‡∏°‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏†‡∏≤‡∏û</h1>
        <p class="puzzle-sub">‡∏•‡∏≤‡∏Å‡πÅ‡∏•‡∏∞‡∏™‡∏•‡∏±‡∏ö‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á 9 ‡∏ä‡πà‡∏≠‡∏á</p>
        <div class="puzzle-chips">
          <span class="chip">‡∏á‡πà‡∏≤‡∏¢‡∏™‡∏∏‡∏î‡∏™‡∏π‡πä‡∏îüíó</span>
        </div>
      </div>

      <div class="puzzle-grid" id="pGrid"></div>

      <div class="puzzle-actions">
        <br><button id="btnShuffle" class="btn-cute btn-ghost">üîÄ</button><br>
        <br><button id="btnCheck" class="btn-cute">‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button><br>
        <br><button id="btnPreview" class="btn-cute btn-ghost">üí°(${PREVIEW_MAX})</button><br>
      </div>

      <p id="pzStatus" class="puzzle-status"></p>
    </div>
  `;

  const pGrid = document.getElementById("pGrid");
  const pCard = document.getElementById("pCard");
  const status = document.getElementById("pzStatus");
  const btnPreview = document.getElementById("btnPreview");

  let previewCount = 0;

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏¥‡πâ‡∏ô‡∏†‡∏≤‡∏û
  const imageUrls = [
    "https://i.postimg.cc/RCg7K4Cw/image1x1.png",
    "https://i.postimg.cc/k5w4zMpc/image2x1.png",
    "https://i.postimg.cc/j555b0Vr/image3x1.png",
    "https://i.postimg.cc/dVwZxf0J/image1x2.png",
    "https://i.postimg.cc/fLGJj2Fn/image2x2.png",
    "https://i.postimg.cc/kXFBKyvz/image3x2.png",
    "https://i.postimg.cc/xd7Cnp9J/image1x3.png",
    "https://i.postimg.cc/qR37Rc7m/image2x3.png",
    "https://i.postimg.cc/Y2Q9BxZ0/image3x3.png"
  ];

  const pieces = imageUrls.map((url, index) => {
    const img = document.createElement("img");
    img.src = url;
    img.className = "puzzle-piece";
    img.setAttribute("draggable", true);
    img.dataset.correctIndex = index;     // ‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á
    img.setAttribute("data-label", index+1); // ‡πÉ‡∏ä‡πâ‡πÇ‡∏ä‡∏ß‡πå‡πÄ‡∏•‡∏Ç‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≥
    return img;
  });

  // ‡∏ß‡∏≤‡∏á‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
  shuffleArray(pieces);
  pieces.forEach(p => pGrid.appendChild(p));

  // ‡πÄ‡∏õ‡∏¥‡∏î Drag & Drop
  enableDragAndDrop(pGrid);

  // ‡∏õ‡∏∏‡πà‡∏°: ‡∏™‡∏±‡∏ö‡πÉ‡∏´‡∏°‡πà
  document.getElementById("btnShuffle").addEventListener("click", () => {
    const all = [...pGrid.children];
    shuffleArray(all);
    all.forEach(n => pGrid.appendChild(n));
    status.textContent = "‡∏™‡∏•‡∏±‡∏ö‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß ‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏ó‡∏µ‡∏ô‡πä‡∏≤~ ‚ú®";
    pCard.classList.remove("shake","celebrate");

    // ‚ñº ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ö‡πÉ‡∏´‡∏°‡πà ‡πÉ‡∏´‡πâ uncomment 3 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
    // previewCount = 0;
    // btnPreview.disabled = false;
    // btnPreview.textContent = `‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á üñº (‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ${PREVIEW_MAX})`;
  });

  // ‡∏õ‡∏∏‡πà‡∏°: ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏û (‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á)
  btnPreview.addEventListener("click", () => {
    if (previewCount >= PREVIEW_MAX) {
      // ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏ö‡∏≤ ‡πÜ ‡∏ß‡πà‡∏≤‡πÄ‡∏ï‡πá‡∏°‡πÅ‡∏•‡πâ‡∏ß
      status.textContent = "‡∏Ñ‡∏£‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡πâ‡∏≤ ‚ú®";
      wiggle(btnPreview);
      return;
    }

    previewCount++;
    const left = PREVIEW_MAX - previewCount;
    btnPreview.textContent = left > 0
      ? `üí° ( ${left})`
      : "üí° (0)";

    // ‡∏ñ‡πâ‡∏≤‡∏´‡∏°‡∏î‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤ ‚Üí ‡∏õ‡∏¥‡∏î‡∏õ‡∏∏‡πà‡∏°
    if (left === 0) {
      btnPreview.disabled = true;
      btnPreview.classList.add("btn-disabled");
    }

    openPreviewOverlay(); // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏†‡∏≤‡∏û‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á)
  });



  // ‡∏õ‡∏∏‡πà‡∏°: ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
  document.getElementById("btnCheck").addEventListener("click", () => {
    const current = [...pGrid.children].map(img => img.src.split('/').pop());
    const correct = [
      "image1x1.png","image2x1.png","image3x1.png",
      "image1x2.png","image2x2.png","image3x2.png",
      "image1x3.png","image2x3.png","image3x3.png"
    ];
    const isCorrect = current.every((v,i) => v === correct[i]);

    if (isCorrect) {
      status.textContent = "‡πÄ‡∏¢‡πà! ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß üíï";
      pCard.classList.remove("shake");
      pCard.classList.add("celebrate");
      // ‡πÇ‡∏ä‡∏ß‡πå popup ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
      showSuccessPopup();
    } else {
      status.textContent = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ô‡πâ‡∏≤~ ‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á üß∏";
      pCard.classList.remove("celebrate");
      pCard.classList.add("shake");
      setTimeout(() => pCard.classList.remove("shake"), 400);
    }
  });

  // ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡∏°
  document.body.appendChild(puzzlePage);
  puzzlePage.style.display = "flex";
}


function enableDragAndDrop(puzzleContainer) {
  let draggedItem = null;

  function openGiftVideo() {
  document.getElementById("popupSuccess").style.display = "none";
  window.open("https://www.canva.com/design/DAGvrphMl34/w44lPAbAlAfqbjG5A33Qzw/watch?utm_content=DAGvrphMl34&utm_campaign=designshare&utm_medium=link2&utm_source=uniquelinks&utlId=h332c25f8d2", "_blank"); // ‚Üê ‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏à‡∏£‡∏¥‡∏á
}


  puzzleContainer.addEventListener("dragstart", (e) => {
    if (e.target.tagName === "IMG") {
      draggedItem = e.target;
      e.dataTransfer.effectAllowed = "move";
    }
  });

  puzzleContainer.addEventListener("dragover", (e) => {
    if (e.target.tagName === "IMG") {
      e.preventDefault();
      e.dataTransfer.dropEffect = "move";
    }
  });

  puzzleContainer.addEventListener("drop", (e) => {
    if (e.target.tagName === "IMG" && draggedItem && draggedItem !== e.target) {
      const draggedClone = draggedItem.cloneNode(true);
      const targetClone = e.target.cloneNode(true);

      puzzleContainer.replaceChild(draggedClone, e.target);
      puzzleContainer.replaceChild(targetClone, draggedItem);

      enableDragAndDrop(puzzleContainer); // re-enable after replacement
    }
  });
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏†‡∏≤‡∏û‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏≤‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠)
  function openPreviewOverlay(){
    const overlay = document.createElement("div");
    overlay.style.position = "fixed";
    overlay.style.inset = "0";
    overlay.style.background = "rgba(0,0,0,0.6)";
    overlay.style.display = "flex";
    overlay.style.alignItems = "center";
    overlay.style.justifyContent = "center";
    overlay.style.zIndex = "9999";
    overlay.style.backdropFilter = "blur(4px)";

    const img = document.createElement("img");
    img.src = "https://i.postimg.cc/kMS5v9Vb/S-7806978.jpg"; // <- ‡πÉ‡∏™‡πà‡∏†‡∏≤‡∏û‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
    img.style.width = "min(90vw, 360px)";
    img.style.height = "auto";
    img.style.borderRadius = "14px";
    img.style.boxShadow = "0 8px 24px rgba(0,0,0,0.3)";
    img.style.border = "4px solid white";

    overlay.appendChild(img);
    document.body.appendChild(overlay);

    setTimeout(() => overlay.remove(), 800);
  }

  // ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏™‡∏±‡πà‡∏ô‡πÄ‡∏ö‡∏≤ ‡πÜ ‡∏ï‡∏≠‡∏ô‡∏Å‡∏î‡πÄ‡∏Å‡∏¥‡∏ô‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤
  function wiggle(btn){
    btn.style.transform = "translateX(0)";
    btn.animate([
      { transform: 'translateX(0)' },
      { transform: 'translateX(-4px)' },
      { transform: 'translateX(4px)' },
      { transform: 'translateX(0)' }
    ], { duration: 250, easing: 'ease-out' });
  }

  let giftBoxSparklesTimer = null;

function showGiftBoxPopup(){
  const popup = document.getElementById("giftBoxPopup");
  const card  = popup.querySelector(".box-card");
  popup.classList.remove("hidden");
  startGiftBoxSparkles(card);
}

function closeGiftBoxPopup(){
  document.getElementById("giftBoxPopup").classList.add("hidden");
  stopGiftBoxSparkles();
}

function startGiftBoxSparkles(target, count=8, everyMs=600){
  stopGiftBoxSparkles();
  giftBoxSparklesTimer = setInterval(() => {
    for (let i=0;i<count;i++){
      const s = document.createElement('span');
      s.className = 'box-sparkle';
      s.style.left = (Math.random()* (target.offsetWidth - 16) + 8) + 'px';
      s.style.top  = (Math.random()* (target.offsetHeight - 24) + 12) + 'px';
      s.style.setProperty('--dx', (Math.random()*70 - 35) + 'px');
      target.appendChild(s);
      setTimeout(()=> s.remove(), 2000);
    }
  }, everyMs);
}
function stopGiftBoxSparkles(){
  if (giftBoxSparklesTimer){
    clearInterval(giftBoxSparklesTimer);
    giftBoxSparklesTimer = null;
  }
}




  function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  const giftData = [
  {
    gif: "https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExcXg3em13Ymo5ODlybHBlZXBhMWlwb3lkdTJwaG10MGswaWsyMHk3ZSZlcD12MV9naWZzX3NlYXJjaCZjdD1n/PvHNcl1uBI11MmHhbB/giphy.gif",
    message: "‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ò‡∏≠‡∏°‡∏µ‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏° ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏ò‡∏≠‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç \n‡πÉ‡∏´‡πâ‡∏õ‡∏µ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏™‡∏∏‡∏î ‡πÄ‡∏ï‡πá‡∏°‡πÄ‡∏õ‡∏µ‡πà‡∏¢‡∏°‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å \n‡∏°‡∏µ‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏î‡∏µ‡πÜ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÄ‡∏™‡∏°‡∏≠ ‚Äú ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ò‡∏≠ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏•‡∏Å‡πÉ‡∏à‡∏î‡∏µ‡∏Å‡∏±‡∏ö‡πÄ‡∏ò‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äù\nüéâhappy to youüéâ\n-‡∏Å‡∏µ‡∏ï‡πâ‡∏≤‡∏£‡πå-"
  },
  {
    gif: "https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExcXg3em13Ymo5ODlybHBlZXBhMWlwb3lkdTJwaG10MGswaWsyMHk3ZSZlcD12MV9naWZzX3NlYXJjaCZjdD1n/aoq0zfGvUPxfDGUvFZ/giphy.gif",
    message: "‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ò‡∏≠‡∏°‡∏µ‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏° ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏ò‡∏≠‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç \n‡πÉ‡∏´‡πâ‡∏õ‡∏µ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏™‡∏∏‡∏î ‡πÄ‡∏ï‡πá‡∏°‡πÄ‡∏õ‡∏µ‡πà‡∏¢‡∏°‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å \n‡∏°‡∏µ‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏î‡∏µ‡πÜ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÄ‡∏™‡∏°‡∏≠ ‚Äú ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ò‡∏≠ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏•‡∏Å‡πÉ‡∏à‡∏î‡∏µ‡∏Å‡∏±‡∏ö‡πÄ‡∏ò‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äù\nüéâhappy to youüéâ\n-‡∏Å‡∏µ‡∏ï‡πâ‡∏≤‡∏£‡πå-"
  },
  {
    gif: "https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExMGhkbXNjMjJuY2JjbjhnZnBscXdyMmlweHo1MmRsZXNmZWx3MTFtaCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/kvwiUUHLEacUwgD2R5/giphy.gif",
    message: "‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ò‡∏≠‡∏°‡∏µ‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏° ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏ò‡∏≠‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç \n‡πÉ‡∏´‡πâ‡∏õ‡∏µ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏™‡∏∏‡∏î ‡πÄ‡∏ï‡πá‡∏°‡πÄ‡∏õ‡∏µ‡πà‡∏¢‡∏°‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å \n‡∏°‡∏µ‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏î‡∏µ‡πÜ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÄ‡∏™‡∏°‡∏≠ ‚Äú ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ò‡∏≠ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏•‡∏Å‡πÉ‡∏à‡∏î‡∏µ‡∏Å‡∏±‡∏ö‡πÄ‡∏ò‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äù\nüéâhappy to youüéâ\n-‡∏Å‡∏µ‡∏ï‡πâ‡∏≤‡∏£‡πå-"
  }
];



  let selectedGiftIndex = 0; // ‡πÄ‡∏Å‡πá‡∏ö index ‡πÑ‡∏ß‡πâ

function openGift(index) {
  giftSound.play();
  selectedGiftIndex = index;

  const boxImages = [
    "https://i.postimg.cc/MpMdmyDG/Chat-GPT-Image-6-2568-16-28-12.png",
    "https://i.postimg.cc/MpMdmyDG/Chat-GPT-Image-6-2568-16-28-12.png",
    "https://i.postimg.cc/MpMdmyDG/Chat-GPT-Image-6-2568-16-28-12.png"
  ];
  document.getElementById("selectedBoxImg").src = boxImages[index];
  showGiftBoxPopup();
}

function revealGift() {
  stopGiftBoxSparkles();
  document.getElementById("giftBoxPopup").classList.add("hidden");

  const popup = document.getElementById("giftCardPopup");
  document.getElementById("giftGif").src = giftData[selectedGiftIndex].gif;
  document.getElementById("giftMessage").innerText = giftData[selectedGiftIndex].message;

  popup.classList.remove("hidden");
  launchSurprisePopper();

}




  const giftSound = new Audio("https://www.soundjay.com/buttons/sounds/button-16.mp3");

  function closePopup() {
    document.getElementById("giftCardPopup").classList.add("hidden");
  }

  function showFinalGame() {
    document.getElementById("finalGame").style.display = "flex";
  }

  function launchSurprisePopper() {
  const colors = ['#ff66b2', '#ffcc00', '#66e0ff', '#b266ff', '#ff9966', '#aaffc3'];
  const shots = 4;              // üîÅ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡∏∏‡∏î‡∏¢‡∏¥‡∏á
  const countPerShot = 25;      // üîÅ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏û‡∏•‡∏∏‡∏ï‡πà‡∏≠‡∏ä‡∏∏‡∏î
  const interval = 350;         // ‚è±Ô∏è ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏∏‡∏î (ms)

  for (let i = 0; i < shots; i++) {
    setTimeout(() => {
      for (let j = 0; j < countPerShot; j++) {
        createPopper('left', colors);
        createPopper('right', colors);
      }
    }, i * interval);
  }
}


function createPopper(side, colors) {
  const pop = document.createElement('div');
  pop.classList.add('party-popper');
  pop.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
  pop.style.bottom = '0px';

  if (side === 'left') {
    pop.style.left = '0px';
  } else {
    pop.style.right = '0px';
  }

  const angleDeg = side === 'left'
    ? Math.random() * 40 + 20
    : Math.random() * -40 - 20;

  const angle = angleDeg * (Math.PI / 180);
  const distance = Math.random() * 400 + 200;

  const x = Math.cos(angle) * distance;
  const y = Math.sin(angle) * distance;

  pop.animate([
    { transform: 'translate(0, 0)', opacity: 1 },
    { transform: `translate(${side === 'left' ? x : -x}px, -${Math.abs(y)}px) rotate(720deg)`, opacity: 0 }
  ], {
    duration: 1500 + Math.random() * 300,
    easing: 'ease-out',
    delay: Math.random() * 300,
    fill: 'forwards'
  });

  document.body.appendChild(pop);
  setTimeout(() => pop.remove(), 2000);
}

// ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÅ‡∏™‡∏î‡∏á #finalGame ‡πÅ‡∏•‡πâ‡∏ß (‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏£‡∏µ‡∏¢‡∏Å document.getElementById("finalGame").style.display = "flex"; ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß)
function initFinalGameUI(){
  const grid = document.getElementById('giftGrid');
  if (!grid) return;

  // ‡∏ï‡∏¥‡∏î‡∏Ñ‡∏•‡∏¥‡∏Å‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏Å‡∏•‡πà‡∏≠‡∏á
  grid.querySelectorAll('.gift-card').forEach(btn => {
    btn.addEventListener('click', () => {
      // ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ï‡πå‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
      grid.querySelectorAll('.gift-card').forEach(b => b.classList.remove('is-selected'));
      btn.classList.add('is-selected');

      const idx = parseInt(btn.dataset.index, 10) || 0;
      // ‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
      openGift(idx);
    });
  });
}

// ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤ final game (‡πÅ‡∏ó‡∏£‡∏Å‡∏´‡∏•‡∏±‡∏á‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≥ display:flex)
function goToFinalGame(){
  document.getElementById("popupSuccess").classList.add("hidden");
  puzzlePage.style.display = "none";
  const fg = document.getElementById("finalGame");
  fg.style.display = "flex";
  initFinalGameUI(); // << ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
}

let cardSparklesTimer = null;

function showGiftCard(){
  const popup = document.getElementById("giftCardPopup");
  const card  = popup.querySelector(".card-wrap");
  popup.classList.remove("hidden");

  // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏õ‡∏≤‡∏£‡πå‡∏Å‡πÄ‡∏Ñ‡∏¥‡∏•‡∏ß‡∏ô
  startCardSparkles(card);

  // ‡∏¢‡∏¥‡∏á‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ü‡∏ï‡∏ï‡∏µ‡πâ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ã‡πâ‡∏≥)
  // if (typeof launchSurprisePopper === 'function') launchSurprisePopper();
}

function closeGiftCard(){
  document.getElementById("giftCardPopup").classList.add("hidden");
  stopCardSparkles();
}

function startCardSparkles(target, count=8, everyMs=600){
  stopCardSparkles();
  cardSparklesTimer = setInterval(() => {
    for (let i=0;i<count;i++){
      const s = document.createElement('span');
      s.className = 'card-sparkle';
      s.style.left = (Math.random()* (target.offsetWidth - 16) + 8) + 'px';
      s.style.top  = (Math.random()* (target.offsetHeight - 24) + 12) + 'px';
      s.style.setProperty('--dx', (Math.random()*70 - 35) + 'px');
      target.appendChild(s);
      setTimeout(()=> s.remove(), 2000);
    }
  }, everyMs);
}
function stopCardSparkles(){
  if (cardSparklesTimer){
    clearInterval(cardSparklesTimer);
    cardSparklesTimer = null;
  }
}

/* ‡∏õ‡∏£‡∏±‡∏ö revealGift() ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏´‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î + ‡πÅ‡∏™‡∏î‡∏á popup ‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏µ‡πâ */
function revealGift() {
  // ‡∏õ‡∏¥‡∏î popup ‡∏ä‡∏±‡πâ‡∏ô‡πÅ‡∏£‡∏Å (‡πÅ‡∏•‡∏∞‡∏´‡∏¢‡∏∏‡∏î‡∏™‡∏õ‡∏≤‡∏£‡πå‡∏Å‡πÄ‡∏Ñ‡∏¥‡∏•‡∏Ç‡∏≠‡∏á‡∏ä‡∏±‡πâ‡∏ô‡πÅ‡∏£‡∏Å ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
  document.getElementById("giftBoxPopup").classList.add("hidden");
  stopGiftBoxSparkles && stopGiftBoxSparkles();

  // ‡∏ï‡∏±‡πâ‡∏á GIF ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å giftData[selectedGiftIndex]
  const gif = giftData[selectedGiftIndex].gif;
  const msg = giftData[selectedGiftIndex].message;
  document.getElementById("giftGif").src = gif;
  document.getElementById("giftMessage").innerText = msg;

  // ‡∏ï‡∏±‡πâ‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö GIF
  const dl = document.getElementById("downloadGiftBtn");
  dl.href = gif;

  // ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏à‡∏£‡∏¥‡∏á
  showGiftCard();

  // ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏â‡∏•‡∏≠‡∏á (‡πÉ‡∏ä‡πâ‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°)
  launchSurprisePopper && launchSurprisePopper();
  
}

// ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å (‡∏ã‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏Å‡∏°/‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç)
function returnToHome(){
  // ‡∏ã‡πà‡∏≠‡∏ô popup ‡∏Å‡∏≤‡∏£‡πå‡∏î + ‡∏Ñ‡∏•‡∏≤‡∏™‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÉ‡∏ä‡πâ
  const giftCardPopup = document.getElementById("giftCardPopup");
  if (giftCardPopup) giftCardPopup.classList.add("hidden");
  document.body.classList.remove("no-scroll");

  // ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
  stopCardSparkles && stopCardSparkles();
  stopCelebrationLoop && stopCelebrationLoop();

  // ‡∏ã‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢/‡πÄ‡∏Å‡∏°/‡∏õ‡πä‡∏≠‡∏õ‡∏≠‡∏±‡∏õ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏¢‡∏±‡∏á‡∏Ñ‡πâ‡∏≤‡∏á
  const finalGame = document.getElementById("finalGame");
  if (finalGame) finalGame.style.display = "none";

  if (typeof puzzlePage !== "undefined" && puzzlePage) {
    puzzlePage.style.display = "none";
  }
  const letter = document.getElementById("letterPopup");
  if (letter) letter.classList.add("hidden");
  const success = document.getElementById("popupSuccess");
  if (success) success.classList.add("hidden");
  const box = document.getElementById("giftBoxPopup");
  if (box) box.classList.add("hidden");

  // ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤
  const mainPage = document.getElementById("mainPage");
  if (mainPage){
    mainPage.style.display   = "flex";     // ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡πÄ‡∏Ñ‡∏¢‡πÇ‡∏î‡∏ô set ‡πÄ‡∏õ‡πá‡∏ô none
    mainPage.style.visibility= "visible";
    mainPage.style.opacity   = "1";        // ‡∏°‡∏µ transition opacity ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
  }

  // ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô‡∏™‡∏∏‡∏î
  window.scrollTo({ top: 0, behavior: "smooth" });
}

// ‡πÅ‡∏Å‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏±‡∏ö‡∏ö‡πâ‡∏≤‡∏ô
function closeGiftCard(){
  returnToHome();
}


let celebrationLoopTimer = null;

function startCelebrationLoop(intervalMs = 3000) {
  stopCelebrationLoop(); // ‡∏Å‡∏±‡∏ô‡∏ã‡πâ‡∏≥
  celebrationLoopTimer = setInterval(() => {
    if (typeof launchSurprisePopper === 'function') {
      launchSurprisePopper();
    }
  }, intervalMs);
}

function stopCelebrationLoop() {
  if (celebrationLoopTimer) {
    clearInterval(celebrationLoopTimer);
    celebrationLoopTimer = null;
  }
}

function showGiftCard(){
  const popup = document.getElementById("giftCardPopup");
  const card  = popup.querySelector(".card-wrap");
  popup.classList.remove("hidden");
  startCardSparkles(card);

  // ‚ö° ‡∏¢‡∏¥‡∏á‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ "‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö" ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• popup
  // ‡πÉ‡∏ä‡πâ requestAnimationFrame ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ DOM ‡∏ß‡∏≤‡∏î‡∏Å‡πà‡∏≠‡∏ô 1 ‡πÄ‡∏ü‡∏£‡∏° ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏¢‡∏¥‡∏á
  if (typeof launchSurprisePopper === 'function') {
    requestAnimationFrame(() => {
      launchSurprisePopper();       // ‡∏¢‡∏¥‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏£‡∏≠‡∏ö‡πÅ‡∏£‡∏Å
      startCelebrationLoop(3000);   // ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏ó‡∏∏‡∏Å 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
    });
  } else {
    // ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏î‡∏¥‡∏°
    startCelebrationLoop(3000);
  }
}

function closeGiftCard(){
  document.getElementById("giftCardPopup").classList.add("hidden");
  stopCardSparkles();
  stopCelebrationLoop(); // ‡∏´‡∏¢‡∏∏‡∏î‡∏•‡∏π‡∏õ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏õ‡∏¥‡∏î
}

function revealGift() {
  // ‡∏õ‡∏¥‡∏î popup ‡∏ä‡∏±‡πâ‡∏ô‡πÅ‡∏£‡∏Å
  document.getElementById("giftBoxPopup").classList.add("hidden");
  stopGiftBoxSparkles && stopGiftBoxSparkles();

  // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏¥‡∏ü‡∏ï‡πå
  const gif = giftData[selectedGiftIndex].gif;
  const msg = giftData[selectedGiftIndex].message;

  const gifEl = document.getElementById("giftGif");
  gifEl.setAttribute('crossorigin','anonymous');
  gifEl.src = gif;

  // üîΩ ‡∏ï‡∏±‡πâ‡∏á‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏¢‡πà‡∏≠‡∏¢: "‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏ä‡∏¥‡πâ‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©" (‡∏Ñ‡∏á‡∏ó‡∏µ‡πà) + "‡∏Ñ‡∏∑‡∏≠ ‚Ä¶" (‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏≤‡∏°‡∏Å‡∏•‡πà‡∏≠‡∏á)
  const subValueByBox = ["‡∏Ñ‡∏∑‡∏≠‚Ä¶ ‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏´‡∏°‡∏π‡∏Å‡∏∞‡∏ó‡∏∞/‡∏ä‡∏≤‡∏ö‡∏π", "‡∏Ñ‡∏∑‡∏≠‚Ä¶ ‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤‡∏™‡∏∏‡∏î‡πÇ‡∏õ‡∏£‡∏î", "‡∏Ñ‡∏∑‡∏≠‚Ä¶ ‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏ï‡∏≤‡∏°‡πÉ‡∏à"]; // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢
  const sub = document.getElementById("giftSubTitle");
  sub.innerHTML = `
    <span class="sub-value">${subValueByBox[selectedGiftIndex] || "‡∏Ñ‡∏∑‡∏≠ ‚Ä¶"}</span>
  `;

  document.getElementById("giftMessage").innerText = msg;

  // ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î + ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå
  showGiftCard();
  setGiftQR(VIDEO_URL);

}


// üéµ ‡πÉ‡∏ä‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
const globalClickSound = new Audio("https://www.soundjay.com/buttons/sounds/button-09a.mp3");
globalClickSound.volume = 0.05;

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏î‡∏ñ‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ)
function playClickSound() {
  globalClickSound.currentTime = 0; // ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏ô
  globalClickSound.play();
}

// üìå ‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ö‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡∏°‡∏µ‡πÄ‡∏™‡∏µ‡∏¢‡∏á
document.addEventListener("click", () => {
  playClickSound();
});

// üìå ‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏≤‡∏Å‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏°‡∏µ‡πÄ‡∏™‡∏µ‡∏¢‡∏á
document.addEventListener("dragstart", () => {
  playClickSound();
});

// üìå ‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ß‡∏≤‡∏á‡∏°‡∏µ‡πÄ‡∏™‡∏µ‡∏¢‡∏á
document.addEventListener("drop", () => {
  playClickSound();
});

// ‡πÇ‡∏´‡∏•‡∏î/‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ html2canvas ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏Ñ‡∏õ‡∏Ø ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡πå‡∏î (#cardCanvasArea)
function ensureHtml2Canvas(ready){
  if (window.html2canvas) return ready();
  const s = document.createElement('script');
  s.src = 'https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js';
  s.onload = ready;
  document.head.appendChild(s);
}

function saveCardAsImage(){
  const area = document.getElementById('cardCanvasArea');
  if (!area) return;

  ensureHtml2Canvas(() => {
    html2canvas(area, {
      backgroundColor: null, // ‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™ (‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏õ‡πä‡∏≠‡∏õ‡∏≠‡∏±‡∏õ)
      useCORS: true,         // ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡∏Ç‡πâ‡∏≤‡∏°‡πÇ‡∏î‡πÄ‡∏°‡∏ô (‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏∂‡πà‡∏á CORS ‡∏Ç‡∏≠‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á)
      scale: 2               // ‡∏Ñ‡∏°‡∏ä‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô
    }).then(canvas => {
      canvas.toBlob(blob => {
        if (!blob) return;
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'Happy Card.png';
        a.click();
        URL.revokeObjectURL(url);
      }, 'image/png');
    }).catch(err => {
      alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏≠‡∏≤‡∏à‡∏ï‡∏¥‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤ CORS ‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏û GIF) ‚Äî ‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏°‡∏µ CORS ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÇ‡∏Æ‡∏™‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏≠‡∏á‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö');
      console.error(err);
    });
  });
}

// ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤/‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï QR ‡πÉ‡∏´‡πâ‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠
function setGiftQR(videoUrl){
  const img = document.getElementById('giftQR');
  const a   = document.getElementById('giftQRLink');
  if (!img || !a) return;

  a.href = videoUrl;
  // ‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ QR ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î CORS ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ html2canvas ‡∏à‡∏±‡∏ö‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ
  const api = 'https://api.qrserver.com/v1/create-qr-code/?size=120x120&margin=0&data=';
  img.crossOrigin = 'anonymous';
  img.src = api + encodeURIComponent(videoUrl);
}

// ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πå‡∏î (‡πÉ‡∏ä‡πâ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ó‡∏ô)
const VIDEO_URL = 'https://www.canva.com/design/DAGvrphMl34/w44lPAbAlAfqbjG5A33Qzw/watch?utm_content=DAGvrphMl34&utm_campaign=designshare&utm_medium=link2&utm_source=uniquelinks&utlId=h332c25f8d2';


// ‡∏ú‡∏π‡∏Å‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏ã‡∏ü‡∏Å‡∏≤‡∏£‡πå‡∏î (‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô DOM ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß)
const saveBtn = document.getElementById('saveCardBtn');
if (saveBtn) saveBtn.addEventListener('click', saveCardAsImage);
/* === FORCE OVERRIDE: put this at the very end of your <script> === */
(function () {
  function returnToHome() {
    // ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡πä‡∏≠‡∏õ‡∏≠‡∏±‡∏õ/‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏≤‡∏á
    const ids = ["giftCardPopup", "giftBoxPopup", "popupSuccess", "letterPopup"];
    ids.forEach(id => {
      const el = document.getElementById(id);
      if (el) el.classList.add("hidden");
    });

    // ‡∏ã‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡∏°/‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢
    const finalGame = document.getElementById("finalGame");
    if (finalGame) finalGame.style.display = "none";
    if (typeof puzzlePage !== "undefined" && puzzlePage) {
      puzzlePage.style.display = "none";
    }

    // ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÉ‡∏ä‡πâ no-scroll
    document.body.classList.remove("no-scroll");

    // ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤
    const mainPage = document.getElementById("mainPage");
    if (mainPage) {
      mainPage.style.display = "flex";
      mainPage.style.visibility = "visible";
      mainPage.style.opacity = "1";
    }

    // ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
    if (typeof stopCardSparkles === "function") stopCardSparkles();
    if (typeof stopCelebrationLoop === "function") stopCelebrationLoop();

    // ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô‡∏™‡∏∏‡∏î
    window.scrollTo({ top: 0, behavior: "smooth" });
  }

  // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ closeGiftCard ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô
  window.returnToHome = returnToHome;
  window.closeGiftCard = function () { returnToHome(); };

  // ‡πÄ‡∏ú‡∏∑‡πà‡∏≠ inline onclick ‡∏´‡∏•‡∏∏‡∏î ‡πÉ‡∏´‡πâ‡∏ú‡∏π‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î‡∏î‡πâ‡∏ß‡∏¢
  const btnClose = document.querySelector('#giftCardPopup .btn-ghost');
  if (btnClose) btnClose.onclick = window.closeGiftCard;
})();

</script>
<script defer src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

</body>
</html>
